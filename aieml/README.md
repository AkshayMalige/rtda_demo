# AI Engine-ML Graph: `dense1 → dense2`

This directory hosts the **embedding** graph of the project. It implements the first
two dense layers of the network while leaky ReLU activations run in the
programmable logic. Later stages are implemented in
[`aieml2/`](../aieml2/README.md) and [`aieml3/`](../aieml3/README.md).

1. **`dense1`** – matrix-vector multiply producing the hidden activations.
2. **`dense2`** – second matrix-vector multiply generating the final output that feeds
   the PL leaky ReLU.

## Directory Layout

```
├── graph.cpp    # Instantiates `NeuralNetworkGraph` and runs it for simulation
├── graph.h      # Graph definition and PLIO connections
└── Makefile
```

## Build

The `Makefile` provides two convenience targets:

- `make aiesim` – compile and run cycle-accurate simulation using file-based
  weights.
- `make hw` – build the graph for hardware. This defines the
  `USE_PRELOADED_WEIGHTS` flag so weights are delivered through the shared DMA
  stream.

Both commands produce `Work/libadf.a` inside this directory. To invoke the
compiler directly without the wrapper:

```bash
cd aieml
v++ --compile --mode aie --target hw ./graph.cpp \
    --platform=${PLATFORM} -I./data
```

## Data Flow

The PLIO files consumed by the graph now reside in the project-parent
[`../data/`](../../data) directory. They are generated by
[`data/generate_test_data.py`](../data/generate_test_data.py), which
creates:

- `input_data.txt` and `weights_dense1.txt` for `dense1`
- `leakyrelu_output_part*.txt` and `weights_dense2_part*.txt` for the cascaded
  `dense2`

`graph.h` connects each PLIO port to these files (relative to `DATA_DIR`) so
that simulation reads the pre-generated values at runtime. For environment
setup and detailed data creation instructions, see the
[top-level README](../README.md).


<!-- -0.250920
0.901429
0.463988
0.197317
-0.687963
-0.688011
-0.883833
0.732352 -->