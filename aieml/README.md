# AI Engine-ML Graph: `dense1 → leaky_relu → dense2`

This directory contains the AI Engine-ML (AIE-ML) graph used by the project. The graph
implements a minimal multilayer perceptron with one hidden layer using the sequence:

1. **`dense1`** – matrix-vector multiply producing the hidden activations.
2. **`leaky_relu`** – element-wise activation with a small negative slope.
3. **`dense2`** – second matrix-vector multiply generating the final output.

## Directory Layout

```
├── data/              # Input vectors, weights, and intermediate activations
├── kernels/           # AIE kernels for dense1, leaky_relu, and dense2
├── graph.cpp          # Instantiates `NeuralNetworkGraph` and runs it for simulation
├── graph.h            # Graph definition and PLIO connections
├── include.h          # Common dimension definitions and compile-time constants
├── kernels.h          # Kernel prototypes
├── system_settings.h  # Compilation settings (frequency, platform, etc.)
└── tiling_parameters.h# Parameters for vector widths and cascades
```

## Build

The supplied `Makefile` wraps the standard build flow. From the repository
root, compile the graph with:

```bash
cd aieml
make graph TARGET=hw       # or TARGET=x86sim
```

To invoke the compiler directly without the wrapper:

```bash
cd aieml
v++ --compile --mode aie --target hw ./graph.cpp \
    --platform=${PLATFORM} -I./data -I./kernels
```

Both commands produce `Work/libadf.a` inside this directory.

## Simulation

After a successful build, run cycle-approximate simulation:

```bash
make sim TARGET=hw        # uses `aiesimulator` under the hood
# or run manually
# aiesimulator --pkg-dir=Work --profile --dump-vcd=foo
```

## Data Flow

The `data/` directory holds all PLIO files consumed by the graph. They are
generated by [`data/generate_test_data.py`](data/generate_test_data.py), which
creates:

- `input_data.txt` and `weights_dense1.txt` for `dense1`
- `leakyrelu_output_part*.txt` and `weights_dense2_part*.txt` for the cascaded
  `dense2`

`graph.h` connects each PLIO port to these files so that simulation reads the
pre-generated values at runtime. For environment setup and detailed data
creation instructions, see the [top-level README](../README.md).

