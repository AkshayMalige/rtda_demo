# AI Engine-ML Graph: Single-Layer Dense Network (Output Layer)

This directory implements a minimal single-layer neural network graph with a single dense layer (128×32) for testing and validation purposes. This represents an output projection layer.

## Architecture

### Pipeline
1. **`dense1`** (128×32) – Matrix-vector multiply producing 32-element output from 128-element input

### Layer Configuration
- **Layer**: 128×32 dense layer (INPUT: HIDDEN_SIZE=128, OUTPUT: 32)
- **Cascade**: Single kernel (TP_CASC_LEN_LAYER1=1)
- **No activation**: Direct output from matrix multiply
- Weights loaded via RTP (runtime parameter)

## Directory Layout

```
├── graph.cpp           # Instantiates NeuralNetworkGraph
├── graph.h             # Simple graph definition with single dense layer
├── aie.cfg             # AIE compiler configuration
└── Makefile            # Build targets
```

## Build & Simulation

### Compile AI Engine Graph
```bash
cd aieml8
make graph TARGET=hw       # or TARGET=hw_emu
```
Produces `Work/libadf.a` containing the compiled graph.

### Run AI Engine Simulation
```bash
make sim
```

## Data Flow

### Input/Output PLIO
- **Input**: `layer0_in` reads from `../data/output_input_data.txt` (128 floats)
- **Output**: `layer_out` writes to `../data/subsolver_0_dense_3_output_aie.txt` (32 floats)

### Runtime Parameters (RTP)
Weights provided via RTP:
- `matrixA_dense0_rtp`: 128×32 weight matrix for dense1

### Processing Pipeline
```
input(128) → dense1(128×32) → output(32)
```

## Purpose

This minimal graph serves as:
- **Output Layer Test**: Validates final output projection from hidden representation (128) to output dimension (32)
- **Standalone Validation**: Tests DSPLib matrix-vector multiply in isolation
- **Building Block**: Can be integrated as the final layer in larger multi-stage architectures (aieml9)

## Notes
- Test data is generated by `../data/generate_test_data.py`
- No bias or activation applied - pure linear transformation
- Minimal resource usage: single AIE tile
- This graph represents the "output" component tested independently before integration into aieml9
