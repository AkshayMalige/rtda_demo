[connectivity]
# A single shared mm2s kernel with an AXI4-Stream switch driving the many
# AI Engine input and bias ports.
nk=mm2s_pl:1:mm2s
nk=leaky_relu_pl:4:relu0,relu1,relu2,relu3
nk=leaky_splitter_pl:3:split0,split1,split2
nk=s2mm_pl:1:s2mm_out
nk=axis_switch_pl:1:mm2s_switch

# --- Stream Connections ---
stream_connect=mm2s.s:mm2s_switch.S00_AXIS

# Layer 0 inputs (0-11)
stream_connect=mm2s_switch.M00_AXIS:ai_engine_0.layer0_in_0
stream_connect=mm2s_switch.M01_AXIS:ai_engine_0.layer0_in_1
stream_connect=mm2s_switch.M02_AXIS:ai_engine_0.layer0_in_2
stream_connect=mm2s_switch.M03_AXIS:ai_engine_0.layer0_in_3
stream_connect=mm2s_switch.M04_AXIS:ai_engine_0.layer0_in_4
stream_connect=mm2s_switch.M05_AXIS:ai_engine_0.layer0_in_5
stream_connect=mm2s_switch.M06_AXIS:ai_engine_0.layer0_in_6
stream_connect=mm2s_switch.M07_AXIS:ai_engine_0.layer0_in_7
stream_connect=mm2s_switch.M08_AXIS:ai_engine_0.layer0_in_8
stream_connect=mm2s_switch.M09_AXIS:ai_engine_0.layer0_in_9
stream_connect=mm2s_switch.M10_AXIS:ai_engine_0.layer0_in_10
stream_connect=mm2s_switch.M11_AXIS:ai_engine_0.layer0_in_11

# Shared weight stream and biases
stream_connect=mm2s_switch.M12_AXIS:ai_engine_0.weight_stream
stream_connect=mm2s_switch.M13_AXIS:relu0.bias_stream
stream_connect=mm2s_switch.M14_AXIS:relu1.bias_stream
stream_connect=mm2s_switch.M15_AXIS:relu2.bias_stream
stream_connect=mm2s_switch.M16_AXIS:relu3.bias_stream

# Existing AIE graph connections
stream_connect=ai_engine_0.layer0_out:relu0.in_stream
stream_connect=relu0.out_stream:split0.in_stream
stream_connect=split0.out_stream_0:ai_engine_0.layer1_in_0
stream_connect=split0.out_stream_1:ai_engine_0.layer1_in_1

stream_connect=ai_engine_0.layer1_out:relu1.in_stream
stream_connect=relu1.out_stream:split1.in_stream
stream_connect=split1.out_stream_0:ai_engine_0.layer2_in_0
stream_connect=split1.out_stream_1:ai_engine_0.layer2_in_1

stream_connect=ai_engine_0.layer2_out:relu2.in_stream
stream_connect=relu2.out_stream:split2.in_stream
stream_connect=split2.out_stream_0:ai_engine_0.layer3_in_0
stream_connect=split2.out_stream_1:ai_engine_0.layer3_in_1

stream_connect=ai_engine_0.layer3_out:relu3.in_stream
stream_connect=relu3.out_stream:s2mm_out.s
